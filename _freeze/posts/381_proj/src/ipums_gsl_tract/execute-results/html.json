{
  "hash": "7f565520beac28aa85002fbe3bae876a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"IPUMS data collection and processing\"\nauthor: \"Harrison DeFord\"\ndate: '2022-11-18'\noutput: html_document\n---\n\n\n\nThis document describes the process through which population estimates were made and related to water area values extracted from Google Earth.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ipumsr)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(tidycensus)\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(tidyverse)\n```\n:::\n\n\n\nFirst, a CSV containing information from the 1980, 1990, 2000, and 2010 censuses, all normalized to 2010 geographies, is loaded using `read_nhgis()` from `{ipumsr}`, and only counties bordering the Great Salt Lake were kept.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nut_ts <- read_nhgis(\"../data/nhgis0005_ts_geog2010_tract.csv\") %>%\n  filter(STATE == \"Utah\") %>%\n  filter(str_detect(COUNTY, \"Utah County|Salt Lake County|Davis|Weber|Box Elder|Tooele\")) %>%\n  select(c(1,6,8:17)) %>%\n  pivot_longer(cols = tidyselect::starts_with(\"CL8AA\"))%>%\n  filter(name %in% c(\"CL8AA1990\",\"CL8AA2000\",\"CL8AA2010\",\"CL8AA2020\"))\n```\n:::\n\n\n\nA linear regression model was generated for each census tract. This allows for the interpolation of population data between the 10-year census recurrence interval, before the ACS was begun in 2009.\n\n\n\n\n\n\n\nThe estimated annual populations of each tract were summarized to the level of the entire geography, then ACS 5-year data was used from 2009 onwards. These data sources were combined to yield continuous annual population estimates from 1986 to 2020.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nut_ts.pred <- list()\nfor (i in 1:length(ut_model)){\n  ut_ts.pred[[i]] = data.frame(year = c(1986:2009), \n                               GISJOIN = first(ut_ts.split[[i]]$GISJOIN), \n                               COUNTYA = first(ut_ts.split[[i]]$COUNTYA))\n  ut_ts.pred[[i]]$tpop = round(predict(ut_model[[i]], newdata = ut_ts.pred[[i]]))\n} \nut_ts.pred <- bind_rows(ut_ts.pred)\n\nut_ts.sum <- ut_ts.pred %>%\n  group_by(year)%>%\n  mutate(tpop = sum(tpop)) %>%\n  ungroup()%>%\n  distinct(year, .keep_all = TRUE) %>%\n  select(year, tpop)\n\nut_acs.list <- lapply(c(2010:2020), function(y) get_acs(geography = \"county\", state = \"UT\", year = y, survey = \"acs5\", variables = \"B01001_001\", cache_table = TRUE) %>% mutate(year = y)) %>%\n  bind_rows()\nut_acs.filtered <- ut_acs.list %>% filter(str_detect(NAME, \"Utah County|Salt Lake County|Davis|Weber|Box Elder|Tooele\")) %>%\n  group_by(year) %>%\n  mutate(tpop = sum(estimate))%>%\n  ungroup()%>%\n  distinct(year, .keep_all = TRUE) %>%\n  select(year, tpop)\n\nut_tpop <- bind_rows(ut_ts.sum, ut_acs.filtered)\n```\n:::\n\n\n\nFinally, the population estimates were joined to the water area values obtained from Google Earth Engine, and written to a .csv for use in further processing.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyear_area_gsl <- read_csv(\"../data/year_area_gsl.csv\")\nvars_joined <- left_join(ut_tpop, year_area_gsl) %>% mutate(area_km = (area/1e6), tpop_mn = (tpop/1e6))\nvars_joined <- na.omit(vars_joined)\nwrite_csv(vars_joined, file = \"../data/vars_joined.csv\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}